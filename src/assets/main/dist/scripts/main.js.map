{"version":3,"file":"main/dist/scripts/main.js","mappings":"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","sources":["webpack://craft-embedded-assets/./src/assets/main/src/scripts/Button.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/EmbeddedAssets.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/Emitter.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/Form.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/Modal.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/Preview.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/utilities.ts","webpack://craft-embedded-assets/external var \"jQuery\"","webpack://craft-embedded-assets/webpack/bootstrap","webpack://craft-embedded-assets/webpack/runtime/make namespace object","webpack://craft-embedded-assets/./src/assets/main/src/scripts/main.ts"],"sourcesContent":["import * as $ from 'jquery'\n\nexport default class Button {\n  public $element: JQuery | null\n\n  constructor (label: string) {\n    this.$element = $('<div class=\"embedded-assets_button btn\" data-icon=\"globe\"></div>')\n    this.setLabel(label)\n  }\n\n  public destroy (): void {\n    this.$element?.remove()\n    this.$element = null\n  }\n\n  public setLabel (label: string): void {\n    this.$element?.text(Craft.t('embeddedassets', label))\n  }\n\n  public show (): void {\n    this.$element?.show()\n  }\n\n  public hide (): void {\n    this.$element?.hide()\n  }\n\n  public setActive (flag: boolean = true): void {\n    this.$element?.toggleClass('active', flag)\n  }\n}\n","import Button from './Button'\nimport Emitter from './Emitter'\nimport Modal from './Modal'\n\nexport default class EmbeddedAssets extends Emitter {\n  public modal: Modal | null\n  public buttons: Button[]\n  private _replaceAssetId: string\n  private _currentGetActionTarget: Function\n\n  constructor () {\n    super()\n\n    this._currentGetActionTarget = () => -1\n\n    this.modal = new Modal(() => this._getActionTarget())\n    this.buttons = []\n\n    this.modal.on('hide', () => this.buttons.forEach(b => b.setActive(false)))\n    this.modal.on('save', (e: Event) => this.trigger('save', e))\n  }\n\n  public destroy (): void {\n    if (this.modal !== null) {\n      this.modal.destroy()\n      this.modal = null\n\n      this.trigger('destroy')\n    }\n  }\n\n  public setReplaceAssetId (id: string): void {\n    this._replaceAssetId = id\n  }\n\n  public addButton (\n    button: Button,\n    orientations: string[] = ['bottom', 'top', 'left', 'right'],\n    getActionTarget: Function = () => {},\n    replace: boolean = false\n  ): void {\n    this.buttons.push(button)\n\n    button.$element?.on('click', () => {\n      if (this.modal !== null) {\n        this._currentGetActionTarget = getActionTarget\n\n        this.buttons.forEach((b) => b.setActive(b === button))\n        this.modal.show(button.$element as JQuery, { orientations }, replace)\n        this.modal.form?.setReplace(replace, this._replaceAssetId)\n      }\n    })\n\n    this.trigger('addButton', { button })\n  }\n\n  public removeButton (button: Button): void {\n    this.buttons = this.buttons.filter(b => b !== button)\n\n    this.trigger('removeButton', { button })\n  }\n\n  private _getActionTarget (): void {\n    return this._currentGetActionTarget()\n  }\n}\n","export default class Emitter {\n  private readonly _events: Map<string, Function[]>\n\n  constructor () {\n    this._events = new Map()\n  }\n\n  public on (type: string, callback: Function): void {\n    if (!this._events.has(type)) {\n      this._events.set(type, [])\n    }\n\n    this._events.get(type)?.push(callback)\n  }\n\n  public off (type: string, callback?: Function): void {\n    if (this._events.size > 0) {\n      if (typeof callback !== 'undefined' && this._events.has(type)) {\n        const newList = this._events.get(type)?.filter((fn) => fn !== callback) as Function[]\n\n        if (newList.length > 0) {\n          this._events.set(type, newList)\n        } else {\n          this._events.delete(type)\n        }\n      } else {\n        this._events.delete(type)\n      }\n    }\n  }\n\n  public trigger (type: string, event: Object = {}): void {\n    if (this._events.size > 0 && this._events.has(type)) {\n      event = Object.assign(event, { type })\n\n      this._events.get(type)?.forEach(fn => fn.call(this, event))\n    }\n  }\n}\n","import * as $ from 'jquery'\nimport Emitter from './Emitter'\nimport Preview from './Preview'\nimport { PreviewResizeEvent } from './events'\nimport { PreviewResponse } from './responses'\nimport { uniqueId, isUrl } from './utilities'\n\nexport default class Form extends Emitter {\n  public $body: JQuery | null\n  public $element: JQuery | null\n  public $input: JQuery | null\n  public preview: Preview\n  private _height: number\n  private _heightMonitor: number\n  private _replace: boolean\n  private _replaceAssetId: string\n  private _state: string = 'idle'\n  private _url: string = ''\n\n  constructor (private readonly _getActionTarget: Function = () => {}) {\n    super()\n\n    const inputId = uniqueId()\n    const bodyId = uniqueId()\n\n    const formAction = Craft.getActionUrl('embeddedassets/actions/save')\n\n    this.$element = $(`\n      <form class=\"embedded-assets_form\" action=\"${formAction}\" method=\"post\">\n        <div class=\"embedded-assets_form_field\">\n          <label for=\"${inputId}\">URL</label>\n          <input type=\"text\" placeholder=\"http://\" id=\"${inputId}\" name=\"url\" autocomplete=\"off\" spellcheck=\"false\">\n        </div>\n        <div id=\"${bodyId}\" class=\"embedded-assets_form_body\">\n          <div class=\"spinner\"></div>\n        </div>\n      </form>\n    `)\n\n    this.$input = this.$element.find(`#${inputId}`)\n    this.$body = this.$element.find(`#${bodyId}`)\n\n    this.preview = new Preview()\n    this.$body.prepend(this.preview.$element as JQuery)\n\n    this.preview.on('load', (e: any) => {\n      if (e.url === this._url && this._state === 'requesting') {\n        this.setState('requested')\n      }\n    })\n\n    this.preview.on('timeout', (e: any) => {\n      if (e.url === this._url && this._state === 'requesting') {\n        Craft.cp.displayError(Craft.t('embeddedassets', 'Could not retrieve embed information.'))\n\n        this.setState('idle')\n      }\n    })\n\n    this.preview.on('resize', (e: PreviewResizeEvent) => this.$body?.css('height', `${e.height}px`))\n\n    this.$element.on('submit', (e) => {\n      e.preventDefault()\n\n      const isSameUrl = this._url === this.$input?.val()\n\n      if (this._state === 'idle' || (this._state !== 'saving' && !isSameUrl)) {\n        this.request()\n      } else if (this._state === 'requested' && isSameUrl) {\n        this.save()\n      }\n    })\n\n    this.$input.on('change blur', () => this.request())\n\n    this.$input.on('paste', (e: JQueryEventObject) => {\n      const clipboardData = (e.originalEvent as ClipboardEvent).clipboardData\n      const url = clipboardData?.getData('text')\n\n      this.request(url)\n    })\n\n    this._setupHeightMonitor()\n  }\n\n  public destroy (): void {\n    this.preview.destroy()\n\n    this.$element?.remove()\n    this.$element = null\n    this.$input = null\n    this.$body = null\n\n    window.cancelAnimationFrame(this._heightMonitor)\n\n    this.trigger('destroy')\n  }\n\n  public request (url = this.$input?.val() as string): void {\n    if (this._state !== 'saving' && this._url !== url) {\n      this._url = url\n\n      if (isUrl(url)) {\n        this.setState('requesting')\n        this.preview.request({ url })\n      } else {\n        this.setState('idle')\n      }\n    }\n  }\n\n  public focus (): void {\n    if (this.$input !== null) {\n      const $input = this.$input as JQuery<HTMLInputElement>\n      $input[0].select()\n      $input[0].focus()\n    }\n  }\n\n  public clear (): void {\n    this.$input?.val('')\n    this.trigger('clear')\n    this.setState('idle')\n  }\n\n  public setReplace (replace: boolean, id: string): void {\n    this._replace = replace\n    this._replaceAssetId = id\n  }\n\n  public save (url = this.$input?.val() as string, actionTarget = this._getActionTarget()): void {\n    const data = {\n      ...actionTarget,\n      url,\n      assetId: this._replaceAssetId\n    }\n\n    Craft.queue.push(async () => await new Promise((resolve, reject) => {\n      Craft.sendActionRequest('POST', `embeddedassets/actions/${(this._replace ? 'replace' : 'save')}`, { data })\n        .then((response: PreviewResponse) => {\n          if (this._state === 'saving' && typeof response.data?.success !== 'undefined') {\n            this.clear()\n            this.trigger('save', response.data.payload)\n            resolve(undefined)\n          } else {\n            if (typeof response.data?.error !== 'undefined') {\n              Craft.cp.displayError(response.data.error)\n            }\n\n            this.setState('requested')\n            reject(new Error(response.data?.error))\n          }\n        })\n        .catch(reject)\n    }))\n\n    this.setState('saving')\n  }\n\n  public setState (state: string): void {\n    this._state = state\n    this.$element?.attr('data-state', state)\n\n    switch (state) {\n      case 'idle':\n        this._url = ''\n        this.trigger('idle')\n        break\n      case 'requesting':\n        this.trigger('requesting')\n        break\n      case 'requested':\n        this.trigger('requested')\n        break\n      case 'saving':\n        this.trigger('saving')\n        break\n    }\n  }\n\n  private _setupHeightMonitor (): void {\n    this._height = 0\n\n    const monitorHeight: () => void = () => {\n      const height = this.$element?.height() ?? 0\n\n      if (this._height !== height) {\n        this.trigger('resize', { prevHeight: this._height, height })\n        this._height = height\n      }\n\n      this._heightMonitor = window.requestAnimationFrame(monitorHeight)\n    }\n\n    monitorHeight()\n  }\n}\n","import * as $ from 'jquery'\nimport Emitter from './Emitter'\nimport Form from './Form'\nimport { uniqueId } from './utilities'\n\nexport default class Modal extends Emitter {\n  public $cancel: JQuery\n  public $footer: JQuery | null\n  public $save: JQuery\n  public $spinner: JQuery\n  public form: Form | null\n  public hud: GarnishHUD | null\n  private readonly _monitor: number\n\n  constructor (private readonly _getActionTarget: Function = () => {}) {\n    super()\n\n    this.form = null\n    this.hud = null\n  }\n\n  public create ($target: JQuery, settings = {}): void {\n    settings = Object.assign({\n      hudClass: 'hud embedded-assets_hud',\n      mainClass: 'embedded-assets_hud_main',\n      minBodyWidth: 400\n    }, settings)\n\n    const cancelId = uniqueId()\n    const saveId = uniqueId()\n    const spinnerId = uniqueId()\n    const cancelLabel = Craft.t('app', 'Cancel')\n    const saveLabel = Craft.t('app', 'Save')\n\n    this.$footer = $(`\n      <div class=\"hud-footer embedded-assets_hud_footer\">\n        <div class=\"buttons right\">\n          <div id=\"${cancelId}\" class=\"btn\">${cancelLabel}</div>\n          <div id=\"${saveId}\" class=\"btn submit\">${saveLabel}</div>\n          <div id=\"${spinnerId}\" class=\"spinner hidden\"></div>\n        </div>\n      </div>\n    `)\n\n    this.$cancel = this.$footer.find(`#${cancelId}`)\n    this.$save = this.$footer.find(`#${saveId}`)\n    this.$spinner = this.$footer.find(`#${spinnerId}`)\n\n    this.form = new Form(this._getActionTarget)\n    this.hud = new Garnish.HUD($target, this.form.$element?.add(this.$footer) as JQuery, settings)\n\n    this.trigger('create')\n\n    this.$save.on('click', (e) => this.$save.hasClass('disabled') && e.stopImmediatePropagation())\n\n    this.$cancel.on('click', () => this.form?.clear())\n    this.$save.on('click', () => this.form?.save())\n    this.form.on('submit', () => this.form?.save())\n\n    this.form.on('save', (e: any) => this.trigger('save', e))\n    this.hud.on('show', () => this.trigger('show'))\n    this.hud.on('hide', () => this.trigger('hide'))\n\n    this.form.on('clear', () => this.hide())\n    this.form.on('save', () => this.hide())\n    this.hud.on('show', () => this.form?.request())\n    this.hud.on('show', () => this.form?.focus())\n    this.hud.on('hide', () => this.form?.setState('idle'))\n\n    this.hideFooter()\n    this.form.on('idle', () => this.hideFooter())\n    this.form.on('requesting', () => this.hideFooter())\n    this.form.on('requested', () => this.showFooter())\n\n    this.form.on('idle', () => this.setSaving(false))\n    this.form.on('requesting', () => this.setSaving(false))\n    this.form.on('requested', () => this.setSaving(false))\n    this.form.on('saving', () => this.setSaving())\n    this.form.on('resize', () => this.hud?.updateSizeAndPosition())\n  }\n\n  public destroy (): void {\n    if (this.$footer !== null) {\n      this.$footer.remove()\n      this.$footer = null\n    }\n\n    if (this.form !== null) {\n      this.form.destroy()\n      this.form = null\n    }\n\n    if (this.hud !== null) {\n      this.hud.hide()\n      this.hud.$hud.remove()\n      this.hud.$shade.remove()\n      this.hud = null\n    }\n\n    window.cancelAnimationFrame(this._monitor)\n\n    this.trigger('destroy')\n  }\n\n  public show ($target: JQuery, settings = {}, replace: any): void {\n    if (this.hud !== null) {\n      this.hud.setSettings(settings)\n      this.hud.$trigger = $($target)\n\n      if (this.hud.showing) {\n        this.hud.queueUpdateSizeAndPosition()\n      } else {\n        this.hud.show()\n      }\n    } else {\n      this.create($target, settings)\n      // `this.create()` creates the form\n      this.form?.focus()\n    }\n\n    this.trigger('show')\n  }\n\n  public hide (): void {\n    this.hud?.hide()\n    this.trigger('hide')\n  }\n\n  public hideFooter (): void {\n    this.hud?.$hud.removeClass('show-footer')\n  }\n\n  public showFooter (): void {\n    this.hud?.$hud.addClass('show-footer')\n  }\n\n  public setSaving (enabled = true): void {\n    this.$save.toggleClass('disabled', enabled)\n    this.$spinner.toggleClass('hidden', !enabled)\n  }\n}\n","import * as $ from 'jquery'\nimport Emitter from './Emitter'\nimport { uniqueId } from './utilities'\n\ninterface RequestParameters {\n  assetId?: string\n  callback?: string\n  showContent: 0 | 1\n  url?: string\n}\n\ninterface RequestSettings {\n  assetId?: string\n  callback?: string\n  showContent?: boolean\n  url?: string\n}\n\nexport default class Preview extends Emitter {\n  public $element: JQuery | null\n  public $iframe: JQuery<HTMLIFrameElement>\n  private _$warningTrigger: JQuery | null\n  private _height: number\n  private _heightMonitor: number\n  private _requestTimeout: NodeJS.Timeout\n  private _warningHud: GarnishHUD | null\n\n  constructor () {\n    super()\n\n    if (typeof window.EmbeddedAssetsPreviewMap === 'undefined') {\n      window.EmbeddedAssetsPreviewMap = new Map()\n    }\n\n    const iframeId = uniqueId()\n\n    this.$element = $(`\n      <div class=\"embedded-assets_preview\">\n        <iframe id=\"${iframeId}\" src=\"about:blank\"></iframe>\n      </div>\n    `)\n\n    this.$iframe = this.$element.find(`#${iframeId}`) as JQuery<HTMLIFrameElement>\n\n    this._setupHeightMonitor()\n  }\n\n  public destroy (): void {\n    this.$element?.remove()\n    this.$element = null\n\n    if (this._$warningTrigger !== null) {\n      this._$warningTrigger.remove()\n      this._$warningTrigger = null\n    }\n\n    if (this._warningHud !== null) {\n      this._warningHud.hide()\n      this._warningHud.$hud.remove()\n      this._warningHud.$shade.remove()\n      this._warningHud = null\n    }\n\n    window.cancelAnimationFrame(this._heightMonitor)\n    clearTimeout(this._requestTimeout)\n\n    this.trigger('destroy')\n  }\n\n  public getWindow (): Window | null {\n    return this.$iframe[0].contentWindow\n  }\n\n  public getDocument (): Document | null {\n    return this.getWindow()?.document ?? null\n  }\n\n  public getBody (): HTMLElement | null {\n    return this.getDocument()?.body ?? null\n  }\n\n  public showWarning (): void {\n    const $previewWindow = $(this.getWindow() as Window)\n    const $previewDocument = $(this.getDocument() as Document)\n    const $warning = $previewDocument.find('#warning')\n\n    if ($warning.length > 0) {\n      const { top: frameTop, left: frameLeft } = this.$iframe.offset() as JQueryCoordinates\n      const frameScroll = $previewWindow.scrollTop() as number\n\n      const { top: iconTop, left: iconLeft } = $warning.offset() as JQueryCoordinates\n\n      const top = frameTop - frameScroll + iconTop\n      const left = frameLeft + iconLeft\n      const width = $warning.outerWidth() as number\n      const height = $warning.outerHeight() as number\n\n      if (this._$warningTrigger === null) {\n        this._$warningTrigger = $('<div>').css({\n          position: 'absolute',\n          display: 'none'\n        })\n\n        Garnish.$bod.append(this._$warningTrigger)\n      }\n\n      this._$warningTrigger.css({\n        display: 'block',\n        top: `${top}px`,\n        left: `${left}px`,\n        width: `${width}px`,\n        height: `${height}px`\n      })\n\n      if (this._warningHud === null) {\n        const untrustedSource = Craft.t('embeddedassets', 'This information is coming from an untrusted source.')\n        const securityMeasure = Craft.t('embeddedassets', 'As a security measure embed codes will not be shown.')\n        const $message = $(`\n          <p><strong>${untrustedSource}</strong></p>\n          <p>${securityMeasure}</p>\n        `)\n\n        this._warningHud = new Garnish.HUD(this._$warningTrigger, $message, {\n          hudClass: 'hud info-hud',\n          closeOtherHUDs: false,\n          onHide: () => this._$warningTrigger?.css('display', 'none')\n        })\n      } else {\n        this._warningHud.show()\n      }\n    }\n  }\n\n  public request (settings?: RequestSettings, timeout: number = 15000): void {\n    const reqSettings = Object.assign({\n      showContent: true,\n      callback: uniqueId('embeddedassets')\n    }, settings ?? {}) as RequestSettings\n\n    const previewWindow = this.getWindow()\n\n    if (previewWindow !== null) {\n      clearTimeout(this._requestTimeout)\n\n      const showPreview = Boolean(reqSettings.url ?? reqSettings.assetId)\n      let previewUrl = 'about:blank'\n\n      if (showPreview) {\n        const complete: (trigger: string) => void = (trigger) => {\n          clearTimeout(this._requestTimeout)\n\n          if (window.EmbeddedAssetsPreviewMap?.has(reqSettings.callback as string) ?? false) {\n            window.EmbeddedAssetsPreviewMap?.delete(reqSettings.callback as string)\n          }\n\n          this.trigger(trigger, parameters)\n        }\n\n        window.EmbeddedAssetsPreviewMap?.set(\n          reqSettings.callback as string,\n          () => {\n            this._setupWarning()\n            complete('load')\n          }\n        )\n\n        this._requestTimeout = setTimeout(() => complete('timeout'), timeout)\n\n        const parameters: RequestParameters = {\n          showContent: (reqSettings.showContent ?? true) ? 1 : 0,\n          callback: reqSettings.callback\n        }\n\n        if (typeof reqSettings.url !== 'undefined') {\n          parameters.url = reqSettings.url\n        } else if (typeof reqSettings.assetId !== 'undefined') {\n          parameters.assetId = reqSettings.assetId\n        }\n\n        previewUrl = Craft.getActionUrl('embeddedassets/actions/preview', {\n          ...parameters,\n          url: parameters?.url ?? null\n        })\n      }\n\n      previewWindow.location.replace(previewUrl)\n    }\n  }\n\n  private _setupHeightMonitor (): void {\n    this._height = 0\n\n    const monitorHeight: () => void = () => {\n      const $previewBody = $(this.getBody() ?? $())\n      const height = $previewBody.height() ?? 0\n\n      if (this._height !== height) {\n        this.trigger('resize', { prevHeight: this._height, height })\n        this._height = height\n      }\n\n      this._heightMonitor = window.requestAnimationFrame(monitorHeight)\n    }\n\n    monitorHeight()\n  }\n\n  private _setupWarning (): void {\n    const $previewDocument = $(this.getDocument() ?? $())\n    const $warning = $previewDocument.find('#warning')\n\n    if ($warning.length > 0) {\n      // Just in case\n      $warning.off('.embeddedassets')\n      $warning.on('click.embeddedassets', () => this.showWarning())\n    }\n  }\n}\n","export function monkeypatch (Class: any, method: string, callback: Function): void {\n  const methodFn = Class.prototype[method]\n\n  Class.prototype[method] = function () {\n    methodFn.apply(this, arguments)\n    callback.call(this)\n  }\n}\n\nlet uidCounter = 0\nexport function uniqueId (prefix: string = 'uid'): string {\n  return `${prefix}${Math.random().toString(36).substr(2)}${uidCounter++}`\n}\n\nexport function isUrl (url: string): boolean {\n  return /^https?:\\/\\//.test(url)\n}\n","module.exports = jQuery;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import '../styles/main.scss'\nimport * as $ from 'jquery'\nimport EmbeddedAssets from './EmbeddedAssets'\nimport Button from './Button'\nimport { monkeypatch } from './utilities'\n\ndeclare global {\n  interface Window {\n    EmbeddedAssets: EmbeddedAssets\n    EmbeddedAssetsPreviewMap?: Map<string, FrameRequestCallback>\n  }\n}\n\nconst embeddedAssets = new EmbeddedAssets()\n\nmonkeypatch(Craft.AssetIndex, 'init', function () {\n  const button = new Button('Embed')\n  const replaceButton = new Button('Replace')\n\n  const $uploadButton = this.$uploadButton\n  const inHeader = $uploadButton.closest('#header').length > 0\n  const inModal = $uploadButton.closest('.modal').length > 0\n\n  // Empty array just means no file type restrictions\n  const allowedAssetKinds = this.settings.criteria?.kind ?? []\n\n  let modalOrientations\n\n  if (inHeader) {\n    this.$uploadButton.before(button.$element)\n    this.$uploadButton.before(replaceButton.$element)\n    modalOrientations = ['bottom', 'left', 'right', 'top']\n  } else if (inModal) {\n    this.$uploadButton.after(button.$element)\n    this.$uploadButton.after(replaceButton.$element)\n    modalOrientations = ['top', 'right', 'bottom', 'left']\n  }\n\n  const showButtonIfJsonAllowed: (button: Button, allowedKinds: string | string[]) => void = (button, allowedKinds = []) => {\n    if (typeof allowedKinds === 'string') {\n      allowedKinds = [allowedKinds]\n    }\n\n    // We still need to check the array length, because `allowedKinds` will be an empty array if the\n    // asset field had no restriction on allowed file types\n    if (allowedKinds.length > 0 && !allowedKinds.includes('json')) {\n      button.hide()\n    } else {\n      button.show()\n    }\n  }\n\n  showButtonIfJsonAllowed(button, allowedAssetKinds)\n  replaceButton.hide()\n\n  const getActionTarget: () => Object = () => {\n    const split = this.sourceKey.split(':')\n\n    if (typeof split[split.length - 2] !== 'undefined') {\n      return {\n        targetType: split[split.length - 2],\n        targetUid: split[split.length - 1]\n      }\n    }\n\n    return {}\n  }\n\n  embeddedAssets.addButton(button, modalOrientations, getActionTarget)\n  embeddedAssets.addButton(replaceButton, modalOrientations, getActionTarget, true)\n\n  let idsToSelect: string[] = []\n\n  embeddedAssets.on('save', (e: any) => {\n    idsToSelect.push(e.assetId)\n    this.updateElements()\n  })\n\n  this.on('updateElements', () => {\n    idsToSelect.forEach((id) => this.view.selectElementById(id))\n    idsToSelect = []\n\n    showButtonIfJsonAllowed(button, allowedAssetKinds)\n    replaceButton.hide()\n  })\n\n  this.on('selectionChange', (e: any) => {\n    const selectedItems = e.target.view.elementSelect.$selectedItems\n\n    if (selectedItems.length === 1) {\n      const findAssetEl = $(selectedItems[0]).find('[data-embedded-asset]')\n\n      if (findAssetEl.length > 0) {\n        button.hide()\n        replaceButton.show()\n\n        embeddedAssets.setReplaceAssetId(selectedItems[0].attributes['data-id'].value)\n      } else {\n        showButtonIfJsonAllowed(button, allowedAssetKinds)\n        replaceButton.hide()\n      }\n    } else {\n      showButtonIfJsonAllowed(button, allowedAssetKinds)\n      replaceButton.hide()\n    }\n  })\n})\n\nwindow.EmbeddedAssets = embeddedAssets\n"],"names":["constructor","label","this","$element","$","setLabel","destroy","remove","text","Craft","t","show","hide","setActive","flag","toggleClass","EmbeddedAssets","super","_currentGetActionTarget","modal","_getActionTarget","buttons","on","forEach","b","e","trigger","setReplaceAssetId","id","_replaceAssetId","addButton","button","orientations","getActionTarget","replace","push","form","setReplace","removeButton","filter","_events","Map","type","callback","has","set","get","off","size","newList","fn","length","delete","event","Object","assign","call","Form","_state","_url","inputId","uniqueId","bodyId","formAction","getActionUrl","$input","find","$body","preview","prepend","url","setState","cp","displayError","css","height","preventDefault","isSameUrl","val","request","save","clipboardData","originalEvent","getData","_setupHeightMonitor","window","cancelAnimationFrame","_heightMonitor","isUrl","focus","select","clear","_replace","actionTarget","data","assetId","queue","Promise","resolve","reject","sendActionRequest","then","response","success","payload","undefined","error","Error","catch","state","attr","_height","monitorHeight","prevHeight","requestAnimationFrame","Modal","hud","create","$target","settings","hudClass","mainClass","minBodyWidth","cancelId","saveId","spinnerId","cancelLabel","saveLabel","$footer","$cancel","$save","$spinner","Garnish","HUD","add","hasClass","stopImmediatePropagation","hideFooter","showFooter","setSaving","updateSizeAndPosition","$hud","$shade","_monitor","setSettings","$trigger","showing","queueUpdateSizeAndPosition","removeClass","addClass","enabled","Preview","EmbeddedAssetsPreviewMap","iframeId","$iframe","_$warningTrigger","_warningHud","clearTimeout","_requestTimeout","getWindow","contentWindow","getDocument","document","getBody","body","showWarning","$previewWindow","$warning","top","frameTop","left","frameLeft","offset","frameScroll","scrollTop","iconTop","iconLeft","width","outerWidth","outerHeight","position","display","$bod","append","untrustedSource","securityMeasure","$message","closeOtherHUDs","onHide","timeout","reqSettings","showContent","previewWindow","previewUrl","Boolean","complete","parameters","_setupWarning","setTimeout","location","Class","method","methodFn","prototype","apply","arguments","uidCounter","prefix","Math","random","toString","substr","test","module","exports","jQuery","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","r","Symbol","toStringTag","defineProperty","value","embeddedAssets","monkeypatch","AssetIndex","replaceButton","$uploadButton","inHeader","closest","inModal","allowedAssetKinds","criteria","kind","modalOrientations","before","after","showButtonIfJsonAllowed","allowedKinds","includes","split","sourceKey","targetType","targetUid","idsToSelect","updateElements","view","selectElementById","selectedItems","target","elementSelect","$selectedItems","attributes"],"sourceRoot":""}